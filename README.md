<<<<<<< HEAD
# GeoServer ç»¼åˆæ¼æ´åˆ©ç”¨å¹³å°

ç¾åŒ–åçš„å›¾å½¢åŒ–ç•Œé¢å·¥å…·ï¼Œé›†æˆäº†å¤šä¸ª GeoServer é‡è¦æ¼æ´çš„åˆ©ç”¨åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

### âœ¨ æ¼æ´æ¨¡å—

1. **RCE å‘½ä»¤æ‰§è¡Œ** (CVE-2024-36401)
   - é€šè¿‡ WFS GetPropertyValue å‚æ•°æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤
   - åŸç†ï¼šåˆ©ç”¨ ECQL è¡¨è¾¾å¼å¼•æ“çš„ exec() å‡½æ•°
   - å±å®³ç­‰çº§ï¼šâš ï¸ ä¸¥é‡

2. **å†…å­˜é©¬æ³¨å…¥** (CVE-2024-36401 å˜ä½“)
   - é€šè¿‡ JavaScript å¼•æ“åœ¨å†…å­˜ä¸­æ³¨å…¥æ¶æ„ç±»
   - é…ç½®ï¼šJAVA_AES_BASE64 åŠ å¯†ï¼Œå¯†ç /å¯†é’¥å›ºå®š
   - å±å®³ç­‰çº§ï¼šâš ï¸ ä¸¥é‡ï¼ˆæƒé™æŒä¹…åŒ–ï¼‰

3. **XXE æ³¨å…¥** (CVE-2025-30220)
   - é€šè¿‡æ¶æ„ XSD æ–‡ä»¶è§¦å‘ XML å¤–éƒ¨å®ä½“æ³¨å…¥
   - å¯ç”¨äºæ–‡ä»¶è¯»å–ã€SSRF æˆ– RCE
   - å±å®³ç­‰çº§ï¼šâš ï¸ é«˜

4. **åå¼¹ Shell**
   - åŸºäº RCE å»ºç«‹äº¤äº’å¼åå‘è¿æ¥
   - è·å¾—ç›®æ ‡æœåŠ¡å™¨å‘½ä»¤è¡Œè®¿é—®æƒ
   - å±å®³ç­‰çº§ï¼šğŸ”´ ä¸¥é‡

### ğŸ¨ GUI ç‰¹æ€§

- **ç°ä»£åŒ–ç•Œé¢è®¾è®¡**
  - å·¦ä¾§é¢æ¿ï¼šæ¼æ´æ¨¡å—é€‰æ‹© + è¯¦ç»†æè¿°
  - å³ä¾§é¢æ¿ï¼šå‚æ•°è¾“å…¥ + æ‰§è¡Œç»“æœå±•ç¤º
  - å“åº”å¼å¸ƒå±€ï¼Œè‡ªåŠ¨é€‚é…å‚æ•°å˜åŒ–

- **å…ƒæ•°æ®é©±åŠ¨çš„å‚æ•°è¡¨å•**
  - è‡ªåŠ¨æ ¹æ®é€‰ä¸­æ¨¡å—è°ƒæ•´è¾“å…¥å­—æ®µ
  - åŠ¨æ€æ˜¾ç¤ºå‚æ•°æç¤ºå’Œç¤ºä¾‹

- **ä»£ç†æ”¯æŒ**
  - æ”¯æŒè®¾ç½® HTTP ä»£ç†
  - ä¾¿äºæ¸—é€æµ‹è¯•åœºæ™¯ä¸‹çš„æµé‡ç›‘æ§

- **å®æ—¶åé¦ˆ**
  - å¼‚æ­¥æ‰§è¡Œé˜²æ­¢ UI å¡é¡¿
  - è¯¦ç»†çš„çŠ¶æ€å’Œé”™è¯¯æç¤º

## é¡¹ç›®ç»“æ„

```
geoserver/
â”œâ”€â”€ main.go                 # GUI ä¸»ç¨‹åºå’Œå·¥å…·å‡½æ•°
â”œâ”€â”€ exploits/               # æ¼æ´åˆ©ç”¨æ¨¡å—åŒ…
â”‚   â”œâ”€â”€ httpclient.go      # HTTP å®¢æˆ·ç«¯å°è£…
â”‚   â”œâ”€â”€ rce.go             # å‘½ä»¤æ‰§è¡Œå®ç°
â”‚   â”œâ”€â”€ inject.go          # å†…å­˜é©¬æ³¨å…¥å®ç°
â”‚   â”œâ”€â”€ xxe.go             # XXE åˆ©ç”¨å®ç°
â”‚   â””â”€â”€ reverseshell.go    # åå¼¹ shell å®ç°
â”œâ”€â”€ go.mod                  # Go æ¨¡å—å®šä¹‰
â”œâ”€â”€ go.sum                  # ä¾èµ–ç‰ˆæœ¬é”å®š
â””â”€â”€ README.md              # æœ¬æ–‡æ¡£
```

## æŠ€æœ¯æ ˆ

- **è¯­è¨€**ï¼šGo 1.21+
- **GUI æ¡†æ¶**ï¼šFyne v2.5.1
- **HTTP å®¢æˆ·ç«¯**ï¼šæ ‡å‡†åº“ net/http
- **TLS**ï¼šæ”¯æŒ InsecureSkipVerifyï¼ˆç”¨äºè‡ªç­¾åè¯ä¹¦ï¼‰

## ç¼–è¯‘å’Œè¿è¡Œ

### ç¼–è¯‘

```bash
cd geoserver
go build
```

ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š`gui-exp.exe`

### è¿è¡Œ

```bash
./gui-exp.exe
```

## ä»£ç é‡æ„æ¸…å•

### âœ… å·²å®Œæˆ

1. **æ¨¡å—åŒ–è®¾è®¡**
   - âœ“ å°† 5 ä¸ªæ¼æ´åˆ©ç”¨å‡½æ•°åˆ†ç¦»åˆ°ç‹¬ç«‹æ–‡ä»¶
   - âœ“ åˆ›å»º `exploits` åŒ…ï¼Œç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ¼æ´æ¨¡å—
   - âœ“ æ¯ä¸ªæ¨¡å—é€šè¿‡æ ‡å‡†å‡½æ•°ç­¾åå¯¼å‡ºï¼ˆæ¥å— proxy *url.URL å‚æ•°ï¼‰

2. **GUI ç¾åŒ–**
   - âœ“ åˆ é™¤æ‰€æœ‰æ—§çš„å•ä¸€åŠŸèƒ½æŒ‰é’®
   - âœ“ è®¾è®¡ç°ä»£åŒ–çš„ä¸¤åˆ—å¸ƒå±€ï¼ˆæ¨¡å—é€‰æ‹© + å‚æ•°è¾“å…¥ï¼‰
   - âœ“ å®ç° ExploitModule å…ƒæ•°æ®ç»“æ„
   - âœ“ åŠ¨æ€å‚æ•°è¡¨å•ç”Ÿæˆï¼ˆæ ¹æ®é€‰ä¸­æ¨¡å—æ˜¾ç¤ºä¸åŒå­—æ®µï¼‰
   - âœ“ Markdown æ”¯æŒçš„è¯¦ç»†æè¿°é¢æ¿
   - âœ“ å¼‚æ­¥æ‰§è¡Œå’Œå®æ—¶åé¦ˆ

3. **ä»£ç æ¸…ç†**
   - âœ“ åˆ é™¤è¿‡æ—¶çš„å¯¼å…¥ï¼ˆbytes, crypto/tls, encoding/base64 ç­‰ï¼‰
   - âœ“ åˆ é™¤æ—§çš„ exploit2() å’Œ exploit() å‡½æ•°
   - âœ“ ç»Ÿä¸€æŒ‰é’®å›è°ƒå¤„ç†é€»è¾‘
   - âœ“ ç®€åŒ– proxySettingsWindow() å®ç°

### æ ¸å¿ƒå‡½æ•°è¯´æ˜

#### `formatTargetURL(input string) string`
- åŠŸèƒ½ï¼šå°†ç”¨æˆ·è¾“å…¥çš„ URL æ ¼å¼åŒ–ä¸ºæ ‡å‡†çš„ GeoServer WFS ç«¯ç‚¹
- æ”¯æŒå¤šç§è¾“å…¥æ ¼å¼ï¼šIPã€IP:PORTã€å®Œæ•´ URL ç­‰
- è¿”å›ï¼šæ ‡å‡†åŒ–åçš„ç›®æ ‡ URL æˆ–ç©ºå­—ç¬¦ä¸²ï¼ˆæ ¼å¼é”™è¯¯ï¼‰

#### `executeExploit(moduleName string, targetURL string, params []string) (string, error)`
- åŠŸèƒ½ï¼šè·¯ç”±åˆ°å¯¹åº”çš„æ¼æ´åˆ©ç”¨å‡½æ•°
- å‚æ•°æ£€æŸ¥å’Œé”™è¯¯å¤„ç†
- è¿”å›ï¼šæ‰§è¡Œç»“æœæˆ–é”™è¯¯ä¿¡æ¯

#### `proxySettingsWindow()`
- åŠŸèƒ½ï¼šæ‰“å¼€ä»£ç†é…ç½®çª—å£
- æ”¯æŒä¿å­˜å’Œæ¸…é™¤ä»£ç†è®¾ç½®
- å®æ—¶æ›´æ–°ä¸»çª—å£çš„ä»£ç†æ ‡ç­¾

#### `main()`
- åŠŸèƒ½ï¼šåˆå§‹åŒ– Fyne åº”ç”¨å’Œ GUI
- ç»„ç»‡å·¦å³ä¸¤åˆ—å¸ƒå±€
- å¤„ç†æ¨¡å—é€‰æ‹©å’Œå‚æ•°åŠ¨æ€æ›´æ–°

## ä½¿ç”¨ç¤ºä¾‹

### å‘½ä»¤æ‰§è¡Œ

1. é€‰æ‹© "RCE å‘½ä»¤æ‰§è¡Œ"
2. è¾“å…¥ç›®æ ‡ URLï¼š`http://192.168.1.100:8080`
3. è¾“å…¥å‘½ä»¤ï¼š`cat /etc/passwd`
4. ç‚¹å‡» "æ‰§è¡Œæ¼æ´éªŒè¯"

### å†…å­˜é©¬æ³¨å…¥

1. é€‰æ‹© "å†…å­˜é©¬æ³¨å…¥"
2. è¾“å…¥ç›®æ ‡ URL
3. ç‚¹å‡» "æ‰§è¡Œæ¼æ´éªŒè¯"
4. ä½¿ç”¨æç¤ºçš„é…ç½®ï¼ˆJAVA_AES_BASE64, pass, keyï¼‰è®¿é—® `/*` è·¯å¾„

### XXE æ³¨å…¥

1. é€‰æ‹© "XXE æ³¨å…¥"
2. è¾“å…¥ç›®æ ‡ URL
3. è¾“å…¥æ¶æ„ XSD URLï¼š`http://attacker.com/evil.xsd`
4. ç‚¹å‡» "æ‰§è¡Œæ¼æ´éªŒè¯"

### åå¼¹ Shell

1. é€‰æ‹© "åå¼¹ Shell"
2. è¾“å…¥ç›®æ ‡ URL
3. è¾“å…¥æ”»å‡»æœº IPï¼š`192.168.1.50`
4. è¾“å…¥ç›‘å¬ç«¯å£ï¼š`4444`
5. åœ¨æ”»å‡»æœºä¸Šå¼€å¯ç›‘å¬ï¼š`nc -lvnp 4444`
6. ç‚¹å‡» "æ‰§è¡Œæ¼æ´éªŒè¯"

## å®‰å…¨å»ºè®®

âš ï¸ **å…è´£å£°æ˜**ï¼šæœ¬å·¥å…·ä»…ç”¨äºæˆæƒçš„æ¸—é€æµ‹è¯•å’Œå®‰å…¨ç ”ç©¶ã€‚æœªç»æˆæƒå¯¹ä»–äººç³»ç»Ÿè¿›è¡Œæµ‹è¯•æ˜¯è¿æ³•çš„ã€‚

## è®¸å¯è¯

[å¼€æºè®¸å¯è¯ä¿¡æ¯]

---

**æœ€åæ›´æ–°**ï¼š2026å¹´1æœˆ2æ—¥  
**ç‰ˆæœ¬**ï¼š2.0 (GUI ç¾åŒ–ç‰ˆ)
=======
# Geoserveræ¼æ´å›¾å½¢åŒ–åˆ©ç”¨å·¥å…·ï¼ŒåŠŸèƒ½åŒ…å«å‘½ä»¤æ‰§è¡Œã€åå¼¹shellã€ä½ç‰ˆæœ¬JDKæ³¨å…¥å†…å­˜é©¬ã€XXEæ¼æ´åˆ©ç”¨
<img width="1214" height="928" alt="image" src="https://github.com/user-attachments/assets/a7b5f945-f3cd-4e64-be88-ef068db2af44" />
>>>>>>> 8de26c9d73fa53abb87e175eb674d29c088168ff

